# 🛡️ CyberTracker UA

**Система моніторингу кібератак проти України** — повнофункціональний веб-додаток для автоматичного збору, класифікації, перекладу та звітування про кіберінциденти, спрямовані проти України.

![Python](https://img.shields.io/badge/Python-3.10+-blue?logo=python&logoColor=white)
![Flask](https://img.shields.io/badge/Flask-3.1-green?logo=flask&logoColor=white)
![SQLite](https://img.shields.io/badge/SQLite-Database-blue?logo=sqlite&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-yellow)
![Platform](https://img.shields.io/badge/Platform-Windows%20%7C%20Linux%20%7C%20macOS-lightgrey)

---

## 📋 Зміст

- [Опис проекту](#-опис-проекту)
- [Основні можливості](#-основні-можливості)
- [Архітектура](#-архітектура)
- [Швидкий старт](#-швидкий-старт)
- [Конфігурація](#-конфігурація)
- [Використання](#-використання)
- [API](#-api)
- [Структура проекту](#-структура-проекту)
- [Технології](#-технології)

---

## 🎯 Опис проекту

CyberTracker UA автоматично збирає інформацію про кібератаки проти України з провідних джерел кібербезпеки, класифікує інциденти за типом атаки, сектором та рівнем загрози, перекладає англомовні статті українською та генерує щоденні звіти у форматі Word.

### Конвеєр обробки даних

```
RSS-канали → Парсинг → Фільтрація (Україна) → Класифікація → Збереження в БД
     ↓
Скрапінг повних статей + зображення → Переклад українською → Звіт Word (.docx)
```

---

## ✨ Основні можливості

### 🔍 Збір даних з RSS-каналів
- **5 джерел**: CERT-UA, BleepingComputer, The Record, SecurityWeek, The Hacker News
- Автоматичне оновлення кожні **30 хвилин**
- Фільтрація за **14+ ключовими словами** релевантності до України
- 3-рівнева дедуплікація: унікальність URL, нормалізація URL, подібність заголовків (>85%)

### 🏷️ Автоматична класифікація
- **9 типів атак**: Phishing, Malware, Ransomware, Wiper, DDoS, Exploit, Espionage, Defacement, Supply Chain
- **9 цільових секторів**: Уряд, Енергетика, Оборона, Фінанси, Телеком, Освіта, Медицина, Інфраструктура, Медіа
- **Ідентифікація загрозливих акторів**: UAC-коди (UAC-0001 — UAC-0006), APT28/Fancy Bear, Sandworm, Gamaredon та інші
- **4 рівні критичності**: Критичний, Високий, Середній, Низький (евристичне призначення)
- **MITRE ATT&CK** інтеграція з автоматичним завантаженням бази технік

### 📰 Скрапінг повних статей
- Витягування повного тексту статей за допомогою BeautifulSoup4
- Сайт-специфічні CSS-селектори для кожного джерела + генеричні fallback-селектори
- Завантаження зображень зі статей (до 10 на статтю, мін. 5 КБ)
- Ввічливий краулінг з затримкою 2 секунди між запитами

### 🌐 Переклад українською
- Автоматичний переклад заголовків, описів та повних текстів
- Розбиття довгих текстів на чанки по ~4000 символів на межах абзаців
- Евристичне визначення вже українськомовного контенту (символи і, ї, є, ґ)

### 📊 Інтерактивний дашборд
- **Статистичні картки**: загальна кількість, за місяць, критичні, час останнього оновлення
- **4 графіки** (Chart.js):
  - Динаміка за місяцями (останні 12 місяців)
  - Розподіл за типами атак (кругова діаграма)
  - Розподіл за секторами (горизонтальна стовпчикова)
  - Розподіл за критичністю (кругова діаграма)
- Таблиця останніх 10 інцидентів

### 📄 Генерація звітів Word
- Професійно оформлений документ у кольорах українського прапора
- Метадані кожного інциденту в таблиці
- Зображення зі статей (масштабовані до 5.5 дюймів)
- Повний текст українською (з fallback на оригінал)
- Автоматична генерація щодня о 08:00

### 🔎 Розширений пошук та фільтрація
- Повнотекстовий пошук за заголовком та описом
- Фільтрація за типом атаки, критичністю, джерелом, сектором
- Діапазон дат (від — до)
- Пагінація (20 інцидентів на сторінку)
- Детальна сторінка інциденту з IOC-індикаторами та MITRE ATT&CK посиланнями

---

## 🏗️ Архітектура

```
┌─────────────────────────────────────────────────────────────┐
│                        Web UI (Flask)                       │
│  ┌───────────┐ ┌───────────┐ ┌──────────┐ ┌─────────────┐  │
│  │ Dashboard  │ │ Incidents │ │  Detail  │ │  Add Form   │  │
│  │ (Charts)  │ │  (List)   │ │  (View)  │ │  (Manual)   │  │
│  └───────────┘ └───────────┘ └──────────┘ └─────────────┘  │
├─────────────────────────────────────────────────────────────┤
│                       Flask Routes                          │
│  /  /incidents  /incidents/<id>  /fetch  /scrape            │
│  /translate  /report  /api/incidents  /images/<path>        │
├─────────────────────────────────────────────────────────────┤
│                     Business Logic                          │
│  ┌────────────┐ ┌──────────┐ ┌────────────┐ ┌───────────┐  │
│  │ RSS Parser │ │ Scraper  │ │ Translator │ │  Report   │  │
│  │ + Classify │ │ + Images │ │  + Chunk   │ │ Generator │  │
│  └────────────┘ └──────────┘ └────────────┘ └───────────┘  │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────────────┐  ┌─────────────────────────────────┐  │
│  │   APScheduler    │  │        SQLite Database          │  │
│  │ RSS: every 30min │  │  incidents, fetch_logs tables   │  │
│  │ Report: 08:00    │  │  + images in data/images/       │  │
│  └──────────────────┘  └─────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

---

## 🚀 Швидкий старт

### Вимоги

- **Python 3.10+**
- **pip** (менеджер пакетів Python)
- Підключення до інтернету (для RSS, скрапінгу та перекладу)

### Встановлення

```bash
# 1. Клонувати репозиторій
git clone https://github.com/assa1975/cybertracker-ua.git
cd cybertracker-ua

# 2. Створити віртуальне середовище (рекомендовано)
python -m venv venv

# Windows:
venv\Scripts\activate

# Linux/macOS:
source venv/bin/activate

# 3. Встановити залежності
pip install -r requirements.txt

# 4. Запустити додаток
python run.py
```

### Перший запуск

Після запуску `python run.py`:
1. Автоматично створюється база даних SQLite (`data/cybertracker.db`)
2. Запускається фоновий планувальник (RSS кожні 30 хв, звіт о 08:00)
3. Сервер доступний за адресою: **http://127.0.0.1:5000**

```
=== CyberTracker UA ===
http://127.0.0.1:5000
Press Ctrl+C to stop
```

4. Натисніть кнопку **"Оновити"** в навігації для першого завантаження інцидентів
5. Потім **"Скрапити"** для завантаження повних текстів статей
6. Потім **"Перекласти"** для перекладу українською
7. Кнопка **"Звіт"** генерує Word-файл на Робочому столі

---

## ⚙️ Конфігурація

Основні налаштування знаходяться у файлі `config.py`:

### RSS-канали

```python
RSS_FEEDS = [
    {'name': 'CERT-UA', 'url': 'https://cert.gov.ua/api/articles/rss', 'always_relevant': True},
    {'name': 'BleepingComputer', 'url': 'https://www.bleepingcomputer.com/feed/'},
    {'name': 'The Record', 'url': 'https://therecord.media/feed'},
    {'name': 'SecurityWeek', 'url': 'https://www.securityweek.com/feed/'},
    {'name': 'The Hacker News', 'url': 'https://feeds.feedburner.com/TheHackersNews'},
]
```

### Ключові параметри

| Параметр | Значення | Опис |
|----------|----------|------|
| `FETCH_INTERVAL_MINUTES` | 30 | Інтервал автоматичного оновлення RSS |
| `INCIDENTS_PER_PAGE` | 20 | Кількість інцидентів на сторінці |
| `SECRET_KEY` | `'cybertracker-ua-local-dev-key'` | Ключ сесії Flask |
| `DATABASE_URL` | `sqlite:///data/cybertracker.db` | Шлях до бази даних |

### Додавання нових RSS-каналів

Додайте новий словник до `RSS_FEEDS`:
```python
{'name': 'My Source', 'url': 'https://example.com/feed', 'always_relevant': False}
```
- `always_relevant: True` — всі статті вважаються релевантними (як CERT-UA)
- `always_relevant: False` — фільтрація за ключовими словами України

### Класифікація

Словники для класифікації (двомовні — EN/UA):
- `ATTACK_TYPE_KEYWORDS` — ключові слова для типів атак
- `SECTOR_KEYWORDS` — ключові слова для секторів
- `THREAT_ACTORS` — мапінг UAC-кодів та назв APT-груп
- `UKRAINE_KEYWORDS` — слова для фільтрації релевантності

---

## 📖 Використання

### Веб-інтерфейс

| Сторінка | URL | Опис |
|----------|-----|------|
| Дашборд | `/` | Статистика, графіки, останні інциденти |
| Інциденти | `/incidents` | Пошук, фільтрація, список інцидентів |
| Деталі | `/incidents/<id>` | Повна інформація, текст, зображення |
| Додати | `/incidents/new` | Ручне додавання інциденту |

### Кнопки управління (навігаційна панель)

| Кнопка | Дія |
|--------|-----|
| 🔄 **Оновити** | Завантажити нові інциденти з RSS |
| ⬇️ **Скрапити** | Завантажити повні тексти статей |
| 🌐 **Перекласти** | Перекласти неперекладені інциденти |
| 📄 **Звіт** | Згенерувати Word-звіт на Робочому столі |

### Рекомендований порядок

```
Оновити → Скрапити → Перекласти → Звіт
```

### Автоматичний режим

Планувальник виконує повний конвеєр щодня о **08:00 UTC**:
1. Завантаження RSS-каналів
2. Скрапінг повних статей
3. Переклад українською
4. Генерація звіту за вчорашній день

---

## 🔌 API

### GET `/api/incidents`

Отримати список інцидентів у форматі JSON.

**Параметри запиту:**

| Параметр | Тип | Опис |
|----------|-----|------|
| `q` | string | Пошуковий запит (заголовок/опис) |
| `attack_type` | string | Фільтр за типом атаки |
| `severity` | string | Фільтр за критичністю |
| `source` | string | Фільтр за джерелом |
| `limit` | int | Максимум записів (за замовчуванням 50, макс. 100) |
| `offset` | int | Зміщення для пагінації |

**Приклад запиту:**
```bash
curl "http://127.0.0.1:5000/api/incidents?q=phishing&severity=Критичний&limit=10"
```

**Приклад відповіді:**
```json
{
  "total": 5,
  "incidents": [
    {
      "id": 1,
      "title": "New phishing campaign targets Ukrainian government",
      "title_uk": "Нова фішингова кампанія спрямована на уряд України",
      "description": "...",
      "date": "2026-02-14T10:30:00",
      "source": "The Record",
      "source_url": "https://therecord.media/...",
      "attack_type": "Phishing",
      "target_sector": "Уряд",
      "severity": "Критичний",
      "threat_actor": "APT28 (Fancy Bear)"
    }
  ]
}
```

---

## 📂 Структура проекту

```
cybertracker-ua/
│
├── run.py                    # Точка входу додатку
├── app.py                    # Flask-додаток, маршрути, фільтри
├── config.py                 # Конфігурація: RSS, ключові слова, класифікація
├── models.py                 # SQLAlchemy моделі (Incident, FetchLog)
├── database.py               # Ініціалізація та міграція БД
├── rss_parser.py             # Парсинг RSS, фільтрація, класифікація
├── scraper.py                # Скрапінг статей та завантаження зображень
├── translator.py             # Переклад на українську з чанкуванням
├── report_generator.py       # Генерація Word-звітів (.docx)
├── scheduler.py              # Фонові задачі (APScheduler)
├── mitre_data.py             # Інтеграція з MITRE ATT&CK
├── requirements.txt          # Залежності Python
├── .gitignore                # Файли, що ігноруються Git
│
├── templates/                # Jinja2 HTML-шаблони
│   ├── base.html             # Базовий шаблон (навігація, стилі)
│   ├── dashboard.html        # Дашборд зі статистикою та графіками
│   ├── incidents.html        # Список інцидентів з фільтрацією
│   ├── incident_detail.html  # Детальний перегляд інциденту
│   └── incident_form.html    # Форма додавання інциденту
│
├── static/                   # Статичні файли
│   ├── css/style.css         # Стилі (кольори прапора України)
│   └── js/
│       ├── dashboard.js      # Ініціалізація Chart.js графіків
│       └── incidents.js      # Утиліти сторінки інцидентів
│
└── data/                     # Дані (створюється автоматично, в .gitignore)
    ├── cybertracker.db       # SQLite база даних
    ├── images/               # Завантажені зображення зі статей
    └── attack_techniques.json # Кеш MITRE ATT&CK
```

---

## 🛠️ Технології

| Компонент | Технологія | Версія |
|-----------|------------|--------|
| Веб-фреймворк | Flask | 3.1.0 |
| ORM | SQLAlchemy | 2.0.36 |
| База даних | SQLite | — |
| RSS-парсинг | feedparser | 6.0.11 |
| Планувальник | APScheduler | 3.10.4 |
| HTTP-клієнт | requests | 2.32.3 |
| Переклад | googletrans | 4.0.0rc1 |
| Word-документи | python-docx | 1.1.2 |
| HTML-парсинг | BeautifulSoup4 | 4.12.3 |
| Фронтенд | Bootstrap 5.3 + Chart.js 4.4 | — |
| Іконки | Bootstrap Icons | 1.11.0 |

---

## 📝 Примітки

- **CERT-UA**: Використовує Angular SPA — скрапінг повних текстів недоступний через BeautifulSoup (потребує Selenium/Playwright). RSS-описи все одно зберігаються та перекладаються.
- **googletrans**: Бібліотека використовує неофіційний API Google Translate. При великому навантаженні можливі тимчасові блокування. Для продакшн-використання рекомендується офіційний Google Cloud Translation API.
- **Звіти**: Генеруються на Робочому столі користувача (`~/Desktop/`). Шлях можна змінити в `report_generator.py` (константа `REPORT_DIR`).

---

## 🇺🇦 Слава Україні!

*Розроблено для моніторингу та аналізу кіберзагроз проти України.*
